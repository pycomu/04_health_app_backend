<!DOCTYPE html>
<html land="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style.css" />
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <title>PyCoMu Health Web App</title>

    <script>
      // function scrollWindow(location) {
      //   window.scrollTo(0, location);
      //   console.log("done1")
      // }
      function dark() {
        var element = document.body;
        element.classList.toggle("dark-mode");
      }

    </script>

  </head>
  <body>
    <container class="container">

      <header id="home">
        <!-- here the header with logo and quick buttons -->
        <div class="header-logo">
          <h1>Child Health Web App</h1>
        </div>
        <div class="header-buttons">
          <!-- <div class="header-button-account">
            <button>Sign in</button>
            <p>You have no account ?</p>
            <button>Sign up</button>
          </div> -->
          <div class="header-button-bmi">
            <div>
              <p>Check your children's health <br>and change their condition!</p>
            </div>
            <div>
              <!-- use JS to jump to a specific section -->
            <button onclick="window.location.href='#bmi-check';">Calculate BMI</button>
            </div>
            
          </div>
        </div>
      </header>
      <nav id="navbar">
        <a class="active" href="#home"><!-- <i class="fa fa-fw fa-home"> --></i>Home</a>
        
        <!-- <a onclick="scrollWindow(200)">Services</a> -->

        <!-- <a onclick="scrollWindow2(bmi-check)>BMI Check 2</a>
        <a onclick="scrollWindow(640)">BMI Check</a>
        <a onclick="scrollWindow(2800)">Chatbot</a>
        <a onclick="scrollWindow(3270)">Team</a>
        <a onclick="scrollWindow(4500)">Contact</a> -->


        <a href="#grid" >Services</a>
        <a href="#bmi-check">BMI Check</a>
        <a href="#chatbot">Chatbot</a>
        <a href="#team">Team</a>
        <a href="#contact"> <i class="fa fa-fw fa-envelope"> </i>Contact</a>
        <a onclick="dark()">Light/Dark</a>
        
        


        <!-- sticky nav bar with JS -->
        <!-- <a class="active" href="javascript:void(0)">Home</a>
        <a href="javascript:void(0)">Services</a>
        <a href="javascript:void(0)">BMI Check</a>
        <a href="javascript:void(0)" href="#contact">Contact</a> -->
      </nav>

      <main class="grid" id="grid" >
        <div class="grid-section">
          <!-- or try https://css-tricks.com/snippets/jquery/make-entire-div-clickable/ -->
          <a href="#service1">
            <div class="grid-box">
              <div class="icon-title">
                  <img src="./img/checkmark-icon-2797531_960_720.webp" alt="">
                  <h2><u>Mission and Vison</u></h2>
              </div>
              <p> <span class="highlight">"Our goal </span> is to motivate the next generation
                 to live a healthy lifestyle. Assist young parents in..."</p>
            </div>
          </a>
          <a href="#service2">          
            <div class="grid-box">
              <div class="icon-title">
                  <img src="./img/apple-2316234_960_720.png" alt="">
                  <h2>Nutritional Facts Fruit/Vegetable</h2>
              </div>
              <p> <span class="highlight">The nutrional facts</span> Lorem ipsum dolor sit, amet consectetur adipisicing elit. Consequatur obcaecati incidunt pariatur in doloribus repellat hic nesciunt accusamus tempora. Facere.</p>
            </div>
          </a>
          <a href="#service3">
            <div class="grid-box">
              <div class="icon-title">
                <img src="./img/survey-2316468_960_720.webp" alt="">
                <h2>Private Survey "Children Health</h2>
              </div>
              <p> <span class="highlight">This survey</span> Lorem ipsum dolor sit, amet consectetur adipisicing elit. Consequatur obcaecati incidunt pariatur in doloribus repellat hic nesciunt accusamus tempora. Facere.</p>
            </div>
          </a>
          <a href="#service4">
            <div class="grid-box">
              <div class="icon-title">
                  <img src="./img/stethoscope-icon-2316460_960_720.webp" alt="">
                  <h2>Life expectancy</h2>
              </div>
              <p> <span class="highlight">The Life expectancy </span> is linked to your BMI during you lifetime, especially in younger
                ages. Have a look...</p>
            </div>
          </a>
        </div>
      </main>

      <section class="bmi-check" id="bmi-check">
        
        <div class="bmi_data">
          
          <h1>Please enter your data here *:</h1>
          <h2>(* currently only for adults)</h2>
          <div class="weight">
            <label for="weight">Weight in Kg</label>

            <div class="row">
              <input type="range" min="20" max="200" value="76" id="weight" oninput="calculate()">
              <span id="weight-val">76 kg</span>
          </div>

            <!-- <input type="number" name="weight" id="weight" min="1" max="200" step="1" value ="70" /> -->
          </div>
          <div class="height">
            <label for="height">Height in cm</label>
            
            <div class="row">
              <input type="range" min="100" max="250" value="183" id="height" oninput="calculate()">
              <span id="height-val">183 cm</span>
            </div>
          </div>  
          <div class="display">
            <p id="result">Calculated BMI of ...</p>
            <p id="category">Normal weight</p>
          </div>       
        </div>

        <div class="gauge">
          <div class="gauge__body">
            <div class="gauge__fill"></div>
            <div class="gauge__cover"></div> 
          </div>

        </div> 
        <!-- <div> -->
          <div class="bmicheck-text">
            <p>
              Body mass index (BMI) is an inexpensive and easy screening method for weight 
              category—underweight, healthy weight, overweight, and obesity.<br>
              BMI does not measure body fat directly, but BMI is moderately correlated with 
              more direct measures of body fat. Furthermore, BMI appears to be as strongly 
              correlated with various metabolic and disease outcome as are these more direct measures 
              of body fatness. People who have obesity are at increased risk for many diseases and health conditions.
              <br>https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html
            </p>
          </div>
          <div class="bmi-table">
            <img src="./img/bmi table.jpg" alt="" >
          </div>
          
        <!-- </div> -->
      </section>

      <section class="services" id="services">

        <div id="service1">
          <div class="service-block">
            <h1>Mission and Vison</h1>            
          </div>
          <div class="service-text">
            <p>
            "Our goal is to motivate the next generation to live a healthy lifestyle. Assist young
            parents in understanding the nutritional needs of their children and provide opportunities
              for young brains to learn about their development. Know what you're putting into your 
              body. Here are some healthy dishes to spice up your diet. More insight with minimal data." </p>
          </div>
        </div>
        <hr>
        <div id="service2">
          <div class="service-block">
            <h1>Nutritional Facts Fruit/Vegetable</h1>            
          </div>
          <div class="service-text">
            <p>
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Neque repellat 
              distinctio aperiam aliquid possimus! Non, accusantium atque. Illum animi 
              aliquam velit maxime voluptatem quisquam, harum cumque laboriosam aspernatur quaerat suscipit? </p>
          </div>
        </div>
        <hr>
        <div id="service3">
          <div class="service-block">
            <h1>Private Survey "Children Health</h1>            
          </div>
          <div class="service-text">
            <p>
              To develop the app service ...
            </p>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSfOIHSXuVsHbTf_FFazASrh_hplUTYLYAho4csYhnAixKlxQw/viewform?usp=sf_link" 
            target="_blank">Online Survey</a>
            
          </div>
        </div>
        <hr>
        <div id="service4">
          <div class="service-block">
            <h1>Life expectancy</h1>            
          </div>
          <div class="service-text">
            <p>
              We estimated the average numbers of years lived with and without cardiovascular 
              disease (CVD) in normal weight, overweight, and obese individuals, aged ≥30 years.
              
            </p>
            <p>
              Methods
            </p>
            <p>
              A total of 7529 participants were recruited. The multi-state Markov model was used
               to obtain hazard ratios (HRs) for three transitions (CVD free to nonfatal CVD, CVD 
               free to all-cause death, and nonfatal CVD to all-cause death) stratified by body mass 
               index (BMI) categories at baseline and adjusted for confounders including sex, age, 
               smoking, family history of premature CVD, education and physical activity. Life 
               expectancies (LEs) were also estimated for each transition stratifying by BMI categories and sex.
            </p>
            <p>
              Results
            </p>
            <p>
              We found 986 incident cases of nonfatal CVD and 669 overall deaths (236 CVD deaths) 
              after more than 18 years of follow-up. Overweight and obesity were associated with an 
              increased risk of nonfatal CVD (HR, 1.42 (95% confidence interval (CI) 1.21–1.66) and 
              (1.64, 1.37–1.96), respectively), compared with normal weight individuals. Overweight 
              and obesity were also associated with lower risk of mortality without CVD (0.39, 0.20–0.77) 
              and (0.35, 0.14–0.85), respectively. Among those with CVD, overweight compared with normal 
              weight was associated with a lower risk of mortality (0.72, 0.56–0.94). Total LEs for both 
              men and women with overweight and obesity were not significantly different from their 
              normal weight counterparts. Compared with normal weight individuals, men and women with 
              obesity lived 4.1 (CI: −6.3, −1.3) and 4.3 (−6.4, −2.0) fewer years free of CVD; however, 
              they lived 3.9 (2.1, 6.0) and 3.7 (2.1, 5.6) longer years with CVD than their normal weight 
              counterparts, respectively.
            </p>
            <p>
              Conclusions
            </p>
            <p>
              We demonstrated that although total LE was not influenced by higher BMI; individuals 
              with overweight and obesity could expect longer longevity after diagnosis of nonfatal CVD. 
              These extra years of life impose financial burden on both patients and the health care system.
            </p>  
            <a href="https://www.nature.com/articles/s41366-019-0464-3">Source</a>
          </div>
        </div>
      </section>

      <section class="chatbot" id="chatbot">
        <h1>Our Chatbot for your Q&A</h1>
        <div class="chat" id="chat">
          
          
          <div id="messages" class="messages"></div>
          <input
            id="input"
            type="text"
            placeholder="Write something..."
            autocomplete="off"
            autofocus="true"
          />
        </div>
      </section>

      <section class="team" id="team">
        <div class="teamdetail">
          <h1>Our team...</h1>
          
          <div class=team_pic_left>
            <img src="./img/frau.jpg" alt="" >
            <p>
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Totam enim at ratione natus 
              exercitationem reiciendis fuga dolorum, ab harum delectus quae, pariatur nihil. Voluptate
                officia quos, eos minima exercitationem laboriosam. </p>
          </div>
          <div class=team_pic_right>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Totam enim at ratione natus 
            exercitationem reiciendis fuga dolorum, ab harum delectus quae, pariatur nihil. Voluptate
              officia quos, eos minima exercitationem laboriosam. </p>
            <img src="./img/mann.jpg" alt="" >
          </div>
        </div>

      </section>

      <section class="contact" id="contact">
        <h1>Contact form</h1>
        
        <div class ="userinput">
          <!-- use service of formsubmit.io with temp healthapp gmail account -->
          <form target="_blank" action="https://formsubmit.co/healthappforkids@gmail.com" method="POST">
            <div class="form-group">
              <div class="form-row">
                <div class="col">
                  <input type="text" name="name" class="form-control" placeholder="Full Name" required>
                </div>
                <div class="col">
                  <input type="email" name="email" class="form-control" placeholder="Email Address" required>
                </div>
              </div>
            </div>
            <div class="form-group">
              <textarea placeholder="Your Message" class="form-control" name="message" rows="10" required></textarea>
            </div>
            <button type="reset">Reset</button>
            <button type="submit" class="btn btn-lg btn-dark btn-block">Submit Form</button>
          </form>
        </div>   
      </section>

      <footer>
        <h1>here comes the footer like Impressum</h1>
      </footer>
      
    </container>
  
  <!-- Navi bar JS not really working yet -->
  <script>
    window.onscroll = function() {myFunction()};
    
    var navbar = document.getElementById("navbar");
    var sticky = navbar.offsetTop;
    
    function myFunction() {
      if (window.pageYOffset >= sticky) {
        navbar.classList.add("sticky")
      } else {
        navbar.classList.remove("sticky");
      }
    }
  </script>

  <!-- script for BMI calculation -->
  <script type="text/javascript">

    window.onload = () => {
        calculate()
    };

    function calculate(){
        var bmi;
        var result = document.getElementById("result");
        const gaugeElement = document.querySelector(".gauge");

        var weight = parseInt(document.getElementById("weight").value);
        document.getElementById("weight-val").textContent = weight + " kg";

        var height = parseInt(document.getElementById("height").value);
        document.getElementById("height-val").textContent = height + " cm";

        bmi = (weight / Math.pow( (height/100), 2 )).toFixed(1);
        result.textContent = "Calculated BMI of " + bmi;

        if(bmi < 18.5){
            category = "Underweight 😒";
            result.style.color = "#3a9de4";
            gaugeElement.querySelector(".gauge__fill").style.background = "#3a9de4";
        }
        else if( bmi >= 18.5 && bmi <= 24.9 ){
            category = "Normal Weight 😍";
            result.style.color = "#1fd319";
            gaugeElement.querySelector(".gauge__fill").style.background = "#1fd319";
        }
        else if( bmi >= 25 && bmi <= 29.9 ){
            category = "Overweight 😮";
            result.style.color = "#f1ee24";
            gaugeElement.querySelector(".gauge__fill").style.background = "#f1ee24";
        }
        else if( bmi >= 30 && bmi <= 34.9 ){
            category = "Obese 😱";
            result.style.color = "#f16f24";
            gaugeElement.querySelector(".gauge__fill").style.background = "#f16f24";
        }
        else if( bmi >= 35 && bmi <= 39.9 ){
            category = "Obese II 😱😱";
            result.style.color = "#c21111";
            gaugeElement.querySelector(".gauge__fill").style.background = "#c21111";
        }
        else{
            category = "Obese III 😱😱😱";
            result.style.color = "#7c0606";
            gaugeElement.querySelector(".gauge__fill").style.background = "#7c0606";

        }
        document.getElementById("category").textContent = category;
        
        // draw gauge
        
        value = (bmi/40).toFixed(1);
        if (value > 1) {value = 1};
        // console.log(value);

        gaugeElement.querySelector(".gauge__fill").style.transform = `rotate(${value / 2}turn)`;
        gaugeElement.querySelector(".gauge__fill").style.transition = `transform .5s ease-out`;
        
        gaugeElement.querySelector(".gauge__cover").textContent = `BMI of ${bmi}`;

    }

  </script>
  
  <!-- script for chatbot -->
  <script type="text/javascript">
    // input by user
    const inputField = document.getElementById("input"); 
    
    // listen that the user pushed "enter" key
    inputField.addEventListener("keydown", (e) => {
      if (e.code === "Enter") {
        let input = inputField.value;
        inputField.value = "";
        output(input); // call function output
      }
    });

    // function to clean user input and contact backend for an answer and update chat window
    function output(input) {
      let reply;
      let text = input.toLowerCase().replace(/[^\w\s\d]/gi, ""); // users input
      text = text
        .replace(/ a /g, " ")
        .replace(/whats/g, "what is")
        .replace(/please /g, "")
        .replace(/ please/g, "")
        .replace(/r u/g, "are you");

      // console.log("1 ",text); // just to check
      

      // function to send cleaned user input and contact backend for an answer and update chat window
      get_answer (text) 
    }
    // contact backend and receive an intelligent bot answer
    function get_answer (text) {
      const url = "http://127.0.0.1:8000/playback"; // testing the request function in Fastapi
      const userdata = { "user": text}; // input as a json object into API
      
      // console.log("2 ",userdata); // just to check

      fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(userdata),
        })
        .then(response => {
          if (!response.ok) {
            throw new Error(`Request failed with status ${response.status}`);
          }
          return response.json();
        })
        .then(function (myJson) {          
          reply = myJson.data; // here parameter "data" comes from backend return !

          // console.log("3",reply); // just to check response from API

          // function to use cleaned user input and received bot answer
          addChatEntry(text, reply);
        })
        .catch(function (error) {
          console.log("Error: " + error);
        });      
    }

    // add the users input to chat window and bot answer, firt just type "Typing.." (a fake) 
    // and then overwrite by real answer from bot by algorythm
    function addChatEntry(input, bot_answer) {
      const messagesContainer = document.getElementById("messages");
      
      // console.log("4 ",input, bot_answer); // just to check

      // add users input to chat window "messages"
      let userDiv = document.createElement("div");
      userDiv.id = "user";
      userDiv.className = "user response";
      userDiv.innerHTML = `<span>${input}</span>`;
      messagesContainer.appendChild(userDiv);

      // add bot answer to chat window "messages"
      let botDiv = document.createElement("div");
      let botText = document.createElement("span");
      botDiv.id = "bot";
      botDiv.className = "bot response";
      // first bot is thinking (fake)
      botText.innerText = "Typing...";
      botDiv.appendChild(botText);
      messagesContainer.appendChild(botDiv);

      messagesContainer.scrollTop =
        messagesContainer.scrollHeight - messagesContainer.clientHeight;
      // after some sec. the real bot answer is overwriting the text "Typing..." in chat window "messages"
      setTimeout(() => {
        botText.innerText = `${bot_answer}`;
      }, 800);
    }
  </script>
  
</body>
</html>